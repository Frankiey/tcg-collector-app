<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>The Pokemon Collection</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
  <!-- Vue 3 CDN -->
  <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
  <style>
/* Modern Theme CSS Variables */
:root {
  --bg-gradient: linear-gradient(135deg, #0d0f18, #1c1f2e);
  --card-bg: rgba(35, 38, 56, 0.8);
  --card-border: rgba(98, 108, 153, 0.3);
  --shadow-color: rgba(0, 0, 0, 0.3);
  --font-primary: 'Poppins', sans-serif;
  --font-color: #e6ebf7;
  --primary-color: #ff5252;
  --primary-hover: #ff7676;
  --secondary-color: #3a67cf;
  --secondary-hover: #4c7be3;
  --bought-bg: rgba(35, 156, 87, 0.25);
  --success-color: #2ecc71;
  --header-bg: linear-gradient(135deg, #171b2c, #0d0f18);
  --glassmorphism: rgba(29, 32, 43, 0.7);
  --card-glow: 0 0 15px rgba(255, 82, 82, 0.3);
  --pokemon-charizard: #ff5722;
  --pokemon-pikachu: #fdd835;
  --pokemon-psyduck: #42a5f5;
  --pokemon-cubone: #8d6e63;
}

/* Fix for white overflow on Mac */
html {
  background: var(--bg-gradient);
  background-attachment: fixed;
  color: var(--font-color);
  height: 100%;
  overflow-x: hidden;
  overscroll-behavior: none;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: var(--font-primary);
  background: var(--bg-gradient);
  background-attachment: fixed;
  color: var(--font-color);
  margin: 0;
  min-height: 100vh;
  position: relative;
  overflow-x: hidden;
  overscroll-behavior: none;
}

body::before {
  content: '';
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MCIgaGVpZ2h0PSI1MCI+CiAgPGNpcmNsZSBjeD0iMjUiIGN5PSIyNSIgcj0iMTAiIGZpbGw9InJnYmEoMjU1LCAyNTUsIDI1NSwgMC4wMikiIC8+Cjwvc3ZnPg==');
  opacity: 0.4;
  z-index: -1;
}

header {
  background: var(--header-bg);
  padding: 2.5rem 1rem 2rem;
  margin-bottom: 2rem;
  box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
  position: relative;
  overflow: hidden;
}

/* Decorative pokeball background in header */
header::before {
  content: '';
  position: absolute;
  top: -100px;
  right: -100px;
  width: 300px;
  height: 300px;
  border-radius: 50%;
  border: 30px solid rgba(255, 82, 82, 0.15);
  background: radial-gradient(circle at center, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0) 60%);
  z-index: 0;
}

.header-content {
  position: relative;
  z-index: 1;
  max-width: 1400px;
  margin: 0 auto;
}

h1 {
  margin: 0 0 1.5rem;
  font-size: 3rem;
  text-align: center;
  background: linear-gradient(90deg, #ff5252, #ff7b79, #ff5252);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  position: relative;
  font-weight: 700;
  letter-spacing: -0.5px;
  text-shadow: 0 5px 15px rgba(255, 82, 82, 0.2);
}

h1::after {
  content: '';
  position: absolute;
  bottom: -10px;
  left: 50%;
  transform: translateX(-50%);
  width: 80px;
  height: 4px;
  background: linear-gradient(90deg, #ff5252, rgba(255, 82, 82, 0.5));
  border-radius: 2px;
}

/* Tabs Styles */
.tabs-container {
  margin: 0 auto 1.5rem;
  max-width: 1000px;
  padding: 0 1rem;
}

.tabs-nav {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  margin-bottom: 0.5rem;
  overflow-x: auto;
  padding-bottom: 0.5rem;
  scrollbar-width: thin;
  scrollbar-color: var(--primary-color) rgba(255, 255, 255, 0.1);
}

.tabs-nav::-webkit-scrollbar {
  height: 5px;
}

.tabs-nav::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 10px;
}

.tabs-nav::-webkit-scrollbar-thumb {
  background-color: var(--primary-color);
  border-radius: 10px;
}

.tabs-btn {
  background: none;
  border: none;
  color: rgba(255, 255, 255, 0.6);
  padding: 0.5rem;
  border-radius: 4px;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

.tabs-btn:hover {
  background: rgba(255, 255, 255, 0.1);
  color: white;
}

.tabs-btn.active {
  background: var(--primary-color);
  color: white;
}

.tabs-content {
  position: relative;
  background: rgba(30, 33, 48, 0.6);
  border-radius: 8px;
  padding: 0.5rem;
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.tabs {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  padding: 0.5rem;
  max-height: 170px;
  overflow-y: auto;
  scrollbar-width: thin;
  scrollbar-color: var(--primary-color) rgba(255, 255, 255, 0.1);
}

.tabs::-webkit-scrollbar {
  width: 5px;
}

.tabs::-webkit-scrollbar-track {
  background: rgba(255, 255, 255, 0.05);
  border-radius: 10px;
}

.tabs::-webkit-scrollbar-thumb {
  background-color: var(--primary-color);
  border-radius: 10px;
}

.tab {
  background: rgba(58, 63, 92, 0.6);
  border: 1px solid rgba(255, 255, 255, 0.1);
  color: var(--font-color);
  padding: 0.6rem 1rem;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.3s;
  font-weight: 500;
  font-size: 0.9rem;
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.15);
  backdrop-filter: blur(5px);
  display: flex;
  align-items: center;
  gap: 0.5rem;
  position: relative;
}

/* Tab Remove Button */
.tab .remove-btn {
  opacity: 0;
  width: 16px;
  height: 16px;
  background: rgba(255, 82, 82, 0.3);
  border: none;
  border-radius: 50%;
  color: white;
  font-size: 8px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.2s;
  padding: 0;
  margin-left: 4px;
  position: relative;
  flex-shrink: 0;
}

.tab:hover .remove-btn {
  opacity: 1;
}

.tab .remove-btn:hover {
  background: rgba(255, 82, 82, 0.8);
  transform: scale(1.1);
}

/* Collection Views Styles */
.collection-view {
  padding: 1rem;
}

.view-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  padding-bottom: 0.5rem;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.view-header h3 {
  font-size: 1.1rem;
  font-weight: 500;
  margin: 0;
  color: var(--font-color);
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.custom-collection {
  background: rgba(58, 63, 92, 0.4);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 8px;
  padding: 0.8rem;
  margin-bottom: 1rem;
  transition: all 0.3s;
  cursor: pointer;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.custom-collection:hover {
  background: rgba(58, 63, 92, 0.6);
  transform: translateY(-2px);
}

.custom-collection h4 {
  margin: 0;
  font-size: 1rem;
  font-weight: 500;
  color: var(--font-color);
}

.custom-collection p {
  margin: 0.3rem 0 0;
  font-size: 0.85rem;
  color: #a0a9c8;
}

.collection-actions {
  display: flex;
  gap: 0.5rem;
}

.action-btn {
  background: none;
  border: none;
  color: #a0a9c8;
  cursor: pointer;
  font-size: 0.9rem;
  padding: 0.3rem;
  border-radius: 4px;
  transition: all 0.2s;
}

.action-btn:hover {
  color: white;
  background: rgba(255, 255, 255, 0.1);
}

.add-collection-form {
  background: rgba(43, 47, 69, 0.4);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 8px;
  padding: 1rem;
  margin-bottom: 1rem;
}

.form-group {
  margin-bottom: 1rem;
}

.form-group label {
  display: block;
  margin-bottom: 0.5rem;
  font-size: 0.9rem;
  color: #b8bedC;
}

.form-group input, 
.form-group textarea {
  width: 100%;
  padding: 0.7rem;
  background: rgba(21, 23, 34, 0.6);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 4px;
  color: var(--font-color);
  font-family: inherit;
  font-size: 0.9rem;
  transition: all 0.3s;
}

.form-group input:focus,
.form-group textarea:focus {
  outline: none;
  border-color: var(--primary-color);
}

.form-group textarea {
  resize: vertical;
  min-height: 80px;
}

.form-actions {
  display: flex;
  gap: 0.5rem;
  justify-content: flex-end;
}

.form-btn {
  padding: 0.5rem 1rem;
  border-radius: 4px;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.2s;
  border: none;
}

.form-btn-primary {
  background: var(--primary-color);
  color: white;
}

.form-btn-primary:hover {
  background: var(--primary-hover);
}

.form-btn-secondary {
  background: rgba(255, 255, 255, 0.1);
  color: white;
}

.form-btn-secondary:hover {
  background: rgba(255, 255, 255, 0.2);
}

.empty-state {
  text-align: center;
  padding: 2rem 1rem;
  color: #a0a9c8;
}

.empty-state i {
  font-size: 3rem;
  margin-bottom: 1rem;
  opacity: 0.3;
  display: block;
}

.empty-state h4 {
  margin: 0 0 0.5rem;
  font-size: 1.1rem;
  color: var(--font-color);
}

.empty-state p {
  margin: 0 0 1rem;
  font-size: 0.9rem;
}

.btn-add-items {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  background: var(--primary-color);
  color: white;
  border: none;
  border-radius: 4px;
  font-size: 0.9rem;
  cursor: pointer;
  transition: all 0.2s;
}

.btn-add-items:hover {
  background: var(--primary-hover);
  transform: translateY(-2px);
}

.tab::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0) 100%);
  opacity: 0;
  transition: opacity 0.3s;
}

.tab:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.25);
}

.tab:hover::before {
  opacity: 1;
}

.tab.active {
  background: var(--primary-color);
  box-shadow: 0 4px 12px rgba(255, 82, 82, 0.4);
  transform: translateY(-2px);
  border-color: rgba(255, 255, 255, 0.2);
}

/* Pokemon-specific tab colors */
.tab[data-collection="charizard"].active {
  background: var(--pokemon-charizard);
  box-shadow: 0 4px 12px rgba(255, 87, 34, 0.4);
}

.tab[data-collection="pikachu"].active {
  background: var(--pokemon-pikachu);
  color: #333;
  box-shadow: 0 4px 12px rgba(253, 216, 53, 0.4);
}

.tab[data-collection="psyduck"].active {
  background: var(--pokemon-psyduck);
  box-shadow: 0 4px 12px rgba(66, 165, 245, 0.4);
}

.tab[data-collection="cubone"].active {
  background: var(--pokemon-cubone);
  box-shadow: 0 4px 12px rgba(141, 110, 99, 0.4);
}

/* Search Controls */
.controls-wrapper {
  max-width: 1000px;
  margin: 0 auto;
  padding: 0 1rem;
}

.controls-container {
  background: rgba(21, 23, 34, 0.5);
  border-radius: 12px;
  padding: 1rem;
  margin-bottom: 1.5rem;
  border: 1px solid rgba(255, 255, 255, 0.05);
}

.controls-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 1rem;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  padding-bottom: 0.5rem;
}

.controls-header h3 {
  font-size: 1rem;
  font-weight: 500;
  color: #e6ebf7;
  margin: 0;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.toggle-filters {
  background: none;
  border: none;
  color: #a0a9c8;
  font-size: 0.9rem;
  cursor: pointer;
  display: flex;
  align-items: center;
  gap: 0.5rem;
  transition: color 0.2s;
}

.toggle-filters:hover {
  color: white;
}

.search-controls {
  display: grid;
  grid-template-columns: minmax(200px, 1fr) repeat(2, minmax(150px, 1fr));
  gap: 1rem;
  margin-bottom: 1rem;
}

.control-group {
  position: relative;
}

.search-icon {
  position: absolute;
  left: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: #8c91b6;
  font-size: 0.9rem;
  pointer-events: none;
}

.search-controls input,
.search-controls select,
.advanced-filters input {
  width: 100%;
  padding: 0.75rem 1rem 0.75rem 2.2rem;
  border-radius: 6px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  font-size: 0.9rem;
  background: rgba(43, 47, 69, 0.6);
  color: var(--font-color);
  transition: all 0.3s;
  backdrop-filter: blur(10px);
  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.search-controls select {
  appearance: none;
  padding-right: 2.2rem;
  cursor: pointer;
}

.select-wrapper {
  position: relative;
}

.select-wrapper::after {
  content: '\f107';
  font-family: 'Font Awesome 6 Free';
  font-weight: 900;
  position: absolute;
  right: 12px;
  top: 50%;
  transform: translateY(-50%);
  color: #8c91b6;
  pointer-events: none;
}

.search-controls input:focus,
.search-controls select:focus,
.advanced-filters input:focus {
  outline: none;
  border-color: var(--primary-color);
  box-shadow: 0 0 0 2px rgba(255, 82, 82, 0.15);
}

.checkbox-row {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 1.5rem;
  margin-top: 0.5rem;
}

.checkbox-group {
  display: flex;
  align-items: center;
}

.checkbox-group label {
  color: #b8bedC;
  display: flex;
  align-items: center;
  font-size: 0.9rem;
  cursor: pointer;
}

.checkbox-group input[type="checkbox"] {
  appearance: none;
  -webkit-appearance: none;
  width: 1.1rem;
  height: 1.1rem;
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 4px;
  margin-right: 0.5rem;
  display: grid;
  place-content: center;
  transition: all 0.2s;
  cursor: pointer;
  background: rgba(43, 47, 69, 0.6);
}

.checkbox-group input[type="checkbox"]::before {
  content: "";
  width: 0.65rem;
  height: 0.65rem;
  transform: scale(0);
  transition: 120ms transform ease-in-out;
  box-shadow: inset 1em 1em var(--primary-color);
  transform-origin: center;
  clip-path: polygon(14% 44%, 0 65%, 50% 100%, 100% 16%, 80% 0%, 43% 62%);
}

.checkbox-group input[type="checkbox"]:checked {
  background-color: var(--primary-color);
  border-color: var(--primary-color);
}

.checkbox-group input[type="checkbox"]:checked::before {
  transform: scale(1);
}

/* Advanced Filters */
.advanced-filters {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: 1rem;
  margin-top: 1rem;
  padding-top: 1rem;
  border-top: 1px dashed rgba(255, 255, 255, 0.1);
}

/* Refresh Button */
.refresh-btn {
  display: block;
  padding: 0.9rem 2rem;
  background: linear-gradient(135deg, var(--secondary-color), #2c52b3);
  border: none;
  border-radius: 8px;
  color: white;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s;
  font-size: 0.95rem;
  margin: 1.5rem auto;
  box-shadow: 0 4px 10px rgba(58, 103, 207, 0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  width: fit-content;
}

.refresh-btn:hover {
  background: linear-gradient(135deg, #4c7be3, #3354a7);
  transform: translateY(-2px);
  box-shadow: 0 6px 15px rgba(58, 103, 207, 0.4);
}

.refresh-btn:active {
  transform: translateY(1px);
}

.refresh-btn i {
  margin-right: 0.5rem;
}

/* Collection Summary */
.collection-summary {
  background: rgba(29, 32, 47, 0.7);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 10px;
  padding: 1.2rem;
  text-align: center;
  color: #b8bedC;
  font-size: 1rem;
  margin: 0 auto 2rem;
  max-width: 1000px;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 1.5rem;
}

.summary-stat {
  display: flex;
  align-items: center;
  margin: 0 0.5rem;
}

.summary-stat i {
  font-size: 1.5rem;
  margin-right: 0.5rem;
  color: var(--primary-color);
}

.summary-stat span {
  font-weight: 600;
  color: var(--font-color);
  margin-left: 0.25rem;
}

/* Loading Indicator */
.loading-indicator {
  position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0, 0, 0, 0.8);
  z-index: 1500;
  align-items: center;
  justify-content: center;
  backdrop-filter: blur(5px);
}

.spinner {
  width: 80px;
  height: 80px;
  position: relative;
  animation: rotate 2s linear infinite;
}

.spinner .path {
  stroke: var(--primary-color);
  stroke-linecap: round;
  animation: dash 1.5s ease-in-out infinite;
  stroke-width: 5;
}

@keyframes rotate {
  100% {
    transform: rotate(360deg);
  }
}

@keyframes dash {
  0% {
    stroke-dasharray: 1, 150;
    stroke-dashoffset: 0;
  }
  50% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -35;
  }
  100% {
    stroke-dasharray: 90, 150;
    stroke-dashoffset: -124;
  }
}

/* Cards Grid */
main {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 1.5rem 3rem;
}

.cards-container {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1.4rem;
}

/* Fixing the favorites view container to show smaller cards */
.favorites-container {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
  gap: 1rem;
}

.favorites-container .card {
  transform: scale(0.92);
  transform-origin: top center;
  margin-bottom: -0.5rem;
}

.card {
  background: var(--card-bg);
  border-radius: 12px;
  box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
  padding: 0.9rem;
  text-align: center;
  transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  position: relative;
  overflow: hidden;
  cursor: pointer;
  backdrop-filter: blur(5px);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

.card::before {
  content: '';
  position: absolute;
  inset: 0;
  z-index: -1;
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0) 100%);
  opacity: 0;
  transition: opacity 0.4s;
}

.card:hover {
  transform: translateY(-7px) scale(1.02);
  box-shadow: 0 12px 25px rgba(0, 0, 0, 0.3), var(--card-glow);
}

.card:hover::before {
  opacity: 1;
}

.card.bought {
  background: linear-gradient(135deg, var(--bought-bg), rgba(20, 75, 40, 0.3));
}

.card-image-container {
  position: relative;
  padding-bottom: 1rem;
  padding-top: 0.5rem;
}

.card img {
  width: 100%;
  height: auto;
  border-radius: 10px;
  transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
}

.card:hover img {
  transform: scale(1.08);
}

.card .title {
  margin: 1.2rem 0 0.4rem;
  font-weight: 600;
  color: var(--font-color);
  font-size: 1.2rem;
  line-height: 1.3;
}

.card .info {
  font-size: 0.85rem;
  color: #a0a9c8;
  margin-bottom: 1rem;
  line-height: 1.5;
}

.card-badges {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 0.5rem;
  margin-bottom: 1rem;
}

.card-badge {
  background: rgba(58, 103, 207, 0.2);
  border-radius: 20px;
  font-size: 0.75rem;
  padding: 0.3rem 0.8rem;
  color: #a0beff;
  backdrop-filter: blur(5px);
}

.card-actions {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-top: 1rem;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
  padding-top: 1rem;
}

.bought-wrapper {
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.bought-wrapper input[type='checkbox'] {
  appearance: none;
  -webkit-appearance: none;
  width: 1.2rem;
  height: 1.2rem;
  border: 2px solid rgba(255, 255, 255, 0.2);
  border-radius: 4px;
  cursor: pointer;
  position: relative;
  transition: all 0.2s;
  background-color: rgba(255, 255, 255, 0.1);
}

.bought-wrapper input[type='checkbox']:checked {
  background-color: var(--success-color);
  border-color: var(--success-color);
}

.bought-wrapper input[type='checkbox']:checked::after {
  content: '\f00c';
  font-family: 'Font Awesome 6 Free';
  font-weight: 900;
  color: white;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  font-size: 0.7rem;
}

.bought-wrapper label {
  font-size: 0.9rem;
  color: #a0a9c8;
  cursor: pointer;
}

/* Favorite Star */
.favorite-star {
  cursor: pointer;
  font-size: 1.5rem;
  color: rgba(255, 255, 255, 0.2);
  transition: all 0.3s;
}

.favorite-star:hover {
  transform: scale(1.2);
}

.favorite-star.favorited {
  color: gold;
  text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
}

/* External Link Button */
.external-link-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  margin-top: 1rem;
  padding: 0.7rem 1.2rem;
  background: linear-gradient(135deg, var(--primary-color), #e03e3e);
  color: #fff;
  text-decoration: none;
  border-radius: 8px;
  font-size: 0.9rem;
  font-weight: 500;
  transition: all 0.3s;
  box-shadow: 0 4px 10px rgba(255, 82, 82, 0.3);
}

.external-link-btn:hover {
  background: linear-gradient(135deg, #ff7676, #ff5252);
  transform: translateY(-2px);
  box-shadow: 0 6px 15px rgba(255, 82, 82, 0.4);
}

.external-link-btn:active {
  transform: translateY(1px);
}

.external-link-btn i {
  font-size: 0.8rem;
}

/* Modal Styles */
.modal {
  position: fixed;
  z-index: 1000;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0, 0, 0, 0.8);
  backdrop-filter: blur(8px);
  transition: all 0.4s;
}

.modal .modal-content {
  background: linear-gradient(135deg, rgba(35, 38, 56, 0.95), rgba(23, 25, 38, 0.95));
  margin: 5% auto;
  padding: 2.5rem;
  border-radius: 20px;
  width: 90%;
  max-width: 900px;
  position: relative;
  box-shadow: 0 15px 50px rgba(0, 0, 0, 0.5);
  animation: modalIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  color: var(--font-color);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255, 255, 255, 0.1);
}

@keyframes modalIn {
  from {
    opacity: 0;
    transform: translateY(-30px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.modal .close {
  position: absolute;
  top: 20px;
  right: 25px;
  width: 40px;
  height: 40px;
  border-radius: 50%;
  background: rgba(255, 255, 255, 0.1);
  display: flex;
  align-items: center;
  justify-content: center;
  color: #fff;
  font-size: 1.5rem;
  cursor: pointer;
  transition: all 0.3s;
  z-index: 10;
}

.modal .close:hover {
  background: var(--primary-color);
  transform: rotate(90deg);
}

.modal-body {
  display: grid;
  grid-template-columns: 1fr 1.2fr;
  gap: 2.5rem;
}

.modal .modal-image {
  grid-column: 1;
  justify-self: center;
  position: relative;
}

.modal .modal-details {
  grid-column: 2;
}

.modal img {
  max-width: 100%;
  height: auto;
  border-radius: 15px;
  transition: transform 0.3s;
}

.modal img:hover {
  transform: scale(1.03);
}

.modal h2 {
  color: var(--primary-color);
  margin-top: 0;
  margin-bottom: 1.5rem;
  font-size: 2rem;
  position: relative;
  font-weight: 700;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.modal h2::after {
  content: '';
  position: absolute;
  bottom: -8px;
  left: 0;
  width: 50px;
  height: 3px;
  background: var(--primary-color);
  border-radius: 3px;
}

.modal .info-section {
  background: rgba(21, 23, 34, 0.5);
  border-radius: 15px;
  padding: 1.5rem;
  margin-bottom: 1.5rem;
  border: 1px solid rgba(255, 255, 255, 0.05);
}

.modal .info-section h3 {
  margin-top: 0;
  margin-bottom: 1rem;
  color: #e6ebf7;
  font-size: 1.2rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.modal .info-section h3 i {
  color: var(--secondary-color);
}

.modal p {
  font-size: 0.95rem;
  color: #b8bedC;
  line-height: 1.6;
  margin: 0.5rem 0;
}

.modal strong {
  color: #e6ebf7;
}

.modal .price-block {
  margin-bottom: 1rem;
}

.modal .price-title {
  font-weight: 600;
  color: #e6ebf7;
  margin-bottom: 0.8rem;
  display: flex;
  align-items: center;
  gap: 0.5rem;
}

.modal .price-title i {
  color: gold;
}

.modal .price-detail {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
  gap: 0.8rem;
}

.modal .price-item {
  background: rgba(58, 63, 92, 0.4);
  padding: 0.8rem;
  border-radius: 10px;
  box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.05);
  transition: transform 0.3s;
}

.modal .price-item:hover {
  transform: translateY(-3px);
}

.modal .price-label {
  font-size: 0.8rem;
  color: #a0a9c8;
  margin-bottom: 0.3rem;
}

.modal .price-value {
  font-weight: 600;
  color: #4c7be3;
  font-size: 1.1rem;
}

.modal textarea {
  width: 100%;
  height: 100px;
  margin: 0.8rem 0 1rem;
  font-size: 0.95rem;
  padding: 1rem;
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 10px;
  resize: vertical;
  font-family: inherit;
  background: rgba(21, 23, 34, 0.5);
  color: var(--font-color);
  transition: all 0.3s;
}

.modal textarea:focus {
  border-color: var(--secondary-color);
  outline: none;
  box-shadow: 0 0 0 2px rgba(76, 123, 227, 0.2);
}

.modal button.save-note {
  padding: 0.8rem 1.5rem;
  font-size: 0.95rem;
  background: linear-gradient(135deg, var(--success-color), #27ae60);
  color: #fff;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.3s;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  font-weight: 500;
  box-shadow: 0 4px 10px rgba(46, 204, 113, 0.3);
}

.modal button.save-note:hover {
  background: linear-gradient(135deg, #2ecc71, #229954);
  transform: translateY(-2px);
  box-shadow: 0 6px 15px rgba(46, 204, 113, 0.4);
}

.modal button.save-note:active {
  transform: translateY(1px);
}

/* Responsive Adjustments */
@media (max-width: 992px) {
  .modal-body {
    grid-template-columns: 1fr;
    gap: 2rem;
  }
  
  .modal .modal-image,
  .modal .modal-details {
    grid-column: 1;
  }
  
  .modal img {
    max-width: 300px;
    margin: 0 auto;
    display: block;
  }
}

@media (max-width: 768px) {
  h1 {
    font-size: 2.2rem;
  }
  
  .search-controls {
    grid-template-columns: 1fr;
  }
  
  .modal .modal-content {
    padding: 2rem 1.5rem;
    margin: 10% auto;
    width: 95%;
  }
  
  .tab {
    padding: 0.6rem 1rem;
    font-size: 0.9rem;
  }
}

@media (max-width: 480px) {
  .card {
    padding: 1rem;
  }
  
  h1 {
    font-size: 1.8rem;
  }
  
  header {
    padding: 2rem 1rem 1.5rem;
  }
  
  .cards-container {
    grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
    gap: 1.2rem;
  }
  
  .card-badge {
    font-size: 0.7rem;
    padding: 0.2rem 0.6rem;
  }
  
  .card .title {
    font-size: 1.1rem;
  }
  
  .modal h2 {
    font-size: 1.6rem;
  }
}
  </style>
</head>
<body>
  <div id="app">
    <!-- Loading Indicator -->
    <div class="loading-indicator" v-if="loading" style="display: flex;">
      <svg class="spinner" viewBox="0 0 50 50">
        <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>
      </svg>
    </div>

    <header>
      <div class="header-content">
        <h1>The Pokemon Collection</h1>
        <!-- Tabs and views -->
        <div class="tabs-container">
          <div class="tabs-nav">
            <button 
              v-for="view in views" 
              :key="view.id" 
              class="tabs-btn" 
              :class="{ active: currentView === view.id }"
              @click="changeView(view.id)"
            >
              <i :class="view.icon"></i>
            </button>
          </div>
          <div class="tabs-content">
            <!-- Pokemon tabs list -->
            <div class="tabs" id="pokemon-tabs" v-show="currentView === 'all'">
              <button 
                v-for="tab in pokemonTabs" 
                :key="tab.name"
                class="tab" 
                :class="{ active: currentCollection === tab.name.toLowerCase() }"
                :data-collection="tab.name.toLowerCase()"
                @click="selectCollection(tab.name.toLowerCase())"
              >
                <span>{{ tab.name }}</span>
                <span 
                  class="remove-btn" 
                  title="Remove" 
                  @click.stop="handleTabRemoval(tab.name.toLowerCase())"
                >
                  <i class="fas fa-times"></i>
                </span>
              </button>
            </div>
            
            <!-- Add Pokemon Form -->
            <div v-show="currentView === 'add'" style="padding: 1rem;">
              <div style="display: flex; gap: 0.5rem;">
                <input 
                  type="text" 
                  v-model="newPokemonInput" 
                  placeholder="Enter Pokemon name..." 
                  style="flex: 1; padding: 0.5rem; border-radius: 4px; border: 1px solid rgba(255,255,255,0.1); background: rgba(43,47,69,0.6); color: white;"
                  @keyup.enter="addNewPokemon"
                >
                <button 
                  @click="addNewPokemon" 
                  style="background: var(--primary-color); color: white; border: none; border-radius: 4px; padding: 0 1rem; cursor: pointer;"
                >
                  Add
                </button>
                <button 
                  @click="changeView('all')" 
                  style="background: rgba(255,255,255,0.1); color: white; border: none; border-radius: 4px; padding: 0 1rem; cursor: pointer;"
                >
                  Cancel
                </button>
              </div>
            </div>
            
            <!-- Favorites View -->
            <div v-show="currentView === 'favorites'" class="collection-view">
              <div class="view-header">
                <h3><i class="fas fa-star"></i> My Favorite Cards</h3>
              </div>
              <div class="favorites-container">
                <div class="empty-state" v-if="!favoriteCardsList.length">
                  <i class="fas fa-star"></i>
                  <h4>No favorites yet</h4>
                  <p>Star your favorite cards to see them here</p>
                </div>
                <card-component 
                  v-for="card in favoriteCardsList" 
                  :key="card.id" 
                  :card="card" 
                  @toggle-bought="toggleCardBought"
                  @toggle-favorite="toggleCardFavorite"
                  @open-modal="openCardModal"
                ></card-component>
              </div>
            </div>
            
            <!-- Custom Collections View -->
            <div v-show="currentView === 'custom'" class="collection-view">
              <div class="view-header">
                <h3><i class="fas fa-folder"></i> Custom Collections</h3>
                <button @click="showCollectionForm = true" class="action-btn">
                  <i class="fas fa-plus"></i> New Collection
                </button>
              </div>
              <div v-if="showCollectionForm" class="add-collection-form">
                <div class="form-group">
                  <label for="collection-name">Collection Name</label>
                  <input type="text" v-model="newCollection.name" placeholder="E.g., Holographic Cards">
                </div>
                <div class="form-group">
                  <label for="collection-description">Description (Optional)</label>
                  <textarea v-model="newCollection.description" placeholder="What makes this collection special?"></textarea>
                </div>
                <div class="form-group">
                  <label>Collection Type</label>
                  <div style="display: flex; gap: 1rem;">
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                      <input type="radio" v-model="newCollection.type" value="manual"> 
                      <span>Manual (Add cards individually)</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 0.5rem; cursor: pointer;">
                      <input type="radio" v-model="newCollection.type" value="auto"> 
                      <span>Auto (Based on filters)</span>
                    </label>
                  </div>
                </div>
                <div class="form-actions">
                  <button @click="showCollectionForm = false" class="form-btn form-btn-secondary">Cancel</button>
                  <button @click="saveCollection" class="form-btn form-btn-primary">Create Collection</button>
                </div>
              </div>
              <div>
                <div class="empty-state" v-if="!customCollections.length && !showCollectionForm">
                  <i class="fas fa-folder-open"></i>
                  <h4>No custom collections yet</h4>
                  <p>Create a collection to organize your cards</p>
                  <button @click="showCollectionForm = true" class="btn-add-items">
                    <i class="fas fa-plus"></i> Create Collection
                  </button>
                </div>
                <div 
                  v-for="collection in customCollections" 
                  :key="collection.id"
                  class="custom-collection"
                  @click="viewCollection(collection.id)"
                >
                  <div>
                    <h4>{{ collection.name }}</h4>
                    <p>{{ collection.description || "No description" }} • {{ getCollectionCardCount(collection.id) }} cards</p>
                  </div>
                  <div class="collection-actions">
                    <button @click.stop="viewCollection(collection.id)" class="action-btn" title="View Collection">
                      <i class="fas fa-eye"></i>
                    </button>
                    <button @click.stop="editCollection(collection.id)" class="action-btn" title="Edit Collection">
                      <i class="fas fa-pencil-alt"></i>
                    </button>
                    <button @click.stop="deleteCollection(collection.id)" class="action-btn" title="Delete Collection">
                      <i class="fas fa-trash-alt"></i>
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Search and Filter Controls -->
        <div class="controls-wrapper">
          <div class="controls-container">
            <div class="controls-header">
              <h3><i class="fas fa-sliders-h"></i> Filters & Sorting</h3>
              <button @click="toggleAdvancedFilters" class="toggle-filters">
                <span>{{ showAdvancedFilters ? 'Hide Advanced' : 'Show Advanced' }}</span>
                <i :class="showAdvancedFilters ? 'fas fa-chevron-up' : 'fas fa-chevron-down'"></i>
              </button>
            </div>
            <div class="search-controls">
              <div class="control-group">
                <i class="fas fa-search search-icon"></i>
                <input type="text" v-model="searchFilters.query" placeholder="Search by name, set, rarity..." />
              </div>
              <div class="control-group select-wrapper">
                <i class="fas fa-filter search-icon"></i>
                <select v-model="searchFilters.filterValue">
                  <option value="all">All Cards</option>
                  <option value="bought">Bought</option>
                  <option value="notBought">Not Bought</option>
                  <option value="favorites">Favorites</option>
                </select>
              </div>
              <div class="control-group select-wrapper">
                <i class="fas fa-sort search-icon"></i>
                <select v-model="searchFilters.sortValue">
                  <option value="name">Sort by Name</option>
                  <option value="set">Sort by Set</option>
                  <option value="number">Sort by Number</option>
                  <option value="rarity">Sort by Rarity</option>
                  <option value="printYear">Sort by Year</option>
                </select>
              </div>
            </div>
            <div class="checkbox-row">
              <div class="checkbox-group">
                <label>
                  <input type="checkbox" v-model="searchFilters.reverseOrder" /> 
                  Reverse Order
                </label>
              </div>
              <div class="checkbox-group">
                <label>
                  <input type="checkbox" v-model="searchFilters.foilOnly" /> 
                  Foil Cards Only
                </label>
              </div>
              <button @click="refreshCards" class="refresh-btn">
                <i class="fas fa-sync-alt"></i> Refresh
              </button>
            </div>
            <!-- Advanced Filters -->
            <div class="advanced-filters" v-show="showAdvancedFilters">
              <div class="control-group">
                <i class="fas fa-calendar-alt search-icon"></i>
                <input type="text" v-model="searchFilters.year" placeholder="Filter by Year" />
              </div>
              <div class="control-group">
                <i class="fas fa-dollar-sign search-icon"></i>
                <input type="text" v-model.number="searchFilters.priceMin" placeholder="Min Price ($)" />
              </div>
              <div class="control-group">
                <i class="fas fa-dollar-sign search-icon"></i>
                <input type="text" v-model.number="searchFilters.priceMax" placeholder="Max Price ($)" />
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- Collection Summary -->
    <div class="collection-summary">
      <div class="summary-stat">
        <i class="fas fa-layer-group"></i>
        Total Cards: <span>{{ filteredCards.length }}</span>
      </div>
      <div class="summary-stat">
        <i class="fas fa-shopping-cart"></i>
        Bought: <span>{{ boughtCount }}</span>
      </div>
      <div class="summary-stat">
        <i class="fas fa-star"></i>
        Favorites: <span>{{ favoriteCount }}</span>
      </div>
    </div>

    <main>
      <div class="cards-container">
        <div v-if="filteredCards.length === 0" style="text-align: center; grid-column: 1 / -1; padding: 4rem 1rem; color: #a0a9c8; font-size: 1.1rem;">
          <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 1rem; opacity: 0.3;"></i><br>
          No cards found. Try different search criteria.
        </div>
        <card-component 
          v-for="card in filteredCards" 
          :key="card.id" 
          :card="card" 
          @toggle-bought="toggleCardBought"
          @toggle-favorite="toggleCardFavorite"
          @open-modal="openCardModal"
        ></card-component>
      </div>
    </main>

    <!-- Card Modal -->
    <div class="modal" v-if="selectedCard" @click="closeCardModal">
      <div class="modal-content" @click.stop>
        <span class="close" @click="closeCardModal"><i class="fas fa-times"></i></span>
        <div class="modal-body">
          <div class="modal-image">
            <img :src="selectedCard.images.large || selectedCard.images.small" :alt="selectedCard.name">
          </div>
          <div class="modal-details">
            <h2>
              <i :class="'fas fa-' + getTypeIcon(selectedCard.types && selectedCard.types[0] ? selectedCard.types[0].toLowerCase() : 'default')"></i>
              {{ selectedCard.name }}
            </h2>
            
            <!-- Basic Info Section -->
            <div class="info-section">
              <h3><i class="fas fa-info-circle"></i> Card Information</h3>
              <p>
                <strong>Number:</strong> {{ selectedCard.number || 'N/A' }}<br>
                <strong>Set:</strong> {{ selectedCard.set?.name || 'N/A' }}<br>
                <strong>Rarity:</strong> {{ selectedCard.rarity || 'N/A' }}<br>
                <strong>Printing Year:</strong> {{ getReleaseYear(selectedCard) }}<br>
                <strong>Types:</strong> {{ (selectedCard.types || []).join(', ') || 'N/A' }}<br>
                <span v-if="selectedCard.hp"><strong>HP:</strong> {{ selectedCard.hp }}<br></span>
                <span v-if="selectedCard.artist"><strong>Artist:</strong> {{ selectedCard.artist }}</span>
              </p>
            </div>
            
            <!-- Pricing Section -->
            <div class="info-section">
              <h3><i class="fas fa-tag"></i> Pricing Information</h3>
              
              <!-- TCGPlayer Pricing -->
              <div v-if="selectedCard.tcgplayer?.prices" class="price-block">
                <div class="price-title">
                  <i class="fas fa-coins"></i>
                  TCGplayer ({{ Object.keys(selectedCard.tcgplayer.prices)[0].charAt(0).toUpperCase() + Object.keys(selectedCard.tcgplayer.prices)[0].slice(1) }})
                </div>
                <div class="price-detail">
                  <div class="price-item" v-for="(label, key) in {'low': 'Low', 'mid': 'Mid', 'high': 'High', 'market': 'Market'}" :key="key">
                    <div class="price-label">{{ label }}</div>
                    <div class="price-value">{{ formatPrice(getPriceValue(selectedCard, key)) }}</div>
                  </div>
                </div>
                <a :href="selectedCard.tcgplayer.url || 'https://www.tcgplayer.com'" target="_blank" rel="noopener noreferrer" class="external-link-btn">
                  <i class="fas fa-external-link-alt"></i> View on TCGplayer
                </a>
              </div>
              
              <!-- Cardmarket Pricing -->
              <div v-if="selectedCard.cardmarket?.prices" class="price-block">
                <div class="price-title">
                  <i class="fas fa-euro-sign"></i> Cardmarket
                </div>
                <div class="price-detail">
                  <div class="price-item" v-for="(label, key) in {'averageSellPrice': 'Avg Sell', 'lowPrice': 'Low', 'trendPrice': 'Trend', 'avg30': '30d Avg'}" :key="key">
                    <div class="price-label">{{ label }}</div>
                    <div class="price-value">{{ formatPrice(selectedCard.cardmarket.prices[key]) }}</div>
                  </div>
                </div>
                <a :href="selectedCard.cardmarket.url || 'https://www.cardmarket.com'" target="_blank" rel="noopener noreferrer" class="external-link-btn">
                  <i class="fas fa-external-link-alt"></i> View on Cardmarket
                </a>
              </div>
              
              <p v-if="!selectedCard.tcgplayer?.prices && !selectedCard.cardmarket?.prices">
                <i class="fas fa-exclamation-circle"></i> No pricing information available for this card.
              </p>
            </div>
            
            <!-- Notes Section -->
            <div class="info-section">
              <h3><i class="fas fa-sticky-note"></i> Personal Notes</h3>
              <textarea 
                v-model="cardNoteText" 
                placeholder="Add your notes about this card here..."
              ></textarea>
              <button @click="saveCardNote" class="save-note">
                <i class="fas" :class="noteSaved ? 'fa-check' : 'fa-save'"></i>
                {{ noteSaved ? 'Saved!' : 'Save Note' }}
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Card Component
    const CardComponent = {
      props: {
        card: {
          type: Object,
          required: true
        }
      },
      computed: {
        isBought() {
          return this.$root.boughtCards[this.card.id] || false;
        },
        isFavorite() {
          return this.$root.favoriteCards[this.card.id] || false;
        },
        releaseYear() {
          return this.card.set && this.card.set.releaseDate ? this.card.set.releaseDate.split("/")[0] : "";
        }
      },
      methods: {
        toggleBought(e) {
          e.stopPropagation();
          this.$emit('toggle-bought', this.card.id);
        },
        toggleFavorite(e) {
          e.stopPropagation();
          this.$emit('toggle-favorite', this.card.id);
        },
        openModal() {
          this.$emit('open-modal', this.card);
        }
      },
      template: `
        <div class="card" :class="{ bought: isBought }" @click="openModal">
          <div class="card-image-container">
            <img :src="card.images.small" :alt="card.name" loading="lazy">
          </div>
          <div class="title">{{ card.name }}</div>
          <div class="card-badges">
            <span v-if="card.rarity" class="card-badge">{{ card.rarity }}</span>
            <span v-if="releaseYear" class="card-badge">{{ releaseYear }}</span>
          </div>
          <div class="info">
            {{ [card.set?.name ? 'Set: ' + card.set.name : '', card.number ? 'No. ' + card.number : ''].filter(Boolean).join(' • ') }}
          </div>
          <div class="card-actions">
            <div class="bought-wrapper">
              <input 
                type="checkbox" 
                :id="'bought-' + card.id" 
                :checked="isBought"
                @change="toggleBought"
                @click.stop
              >
              <label :for="'bought-' + card.id" @click.stop>Bought</label>
            </div>
            <span 
              class="favorite-star" 
              :class="{ favorited: isFavorite }"
              @click.stop="toggleFavorite"
            >
              <i class="fas fa-star"></i>
            </span>
          </div>
        </div>
      `
    };

    // Vue App
    const app = Vue.createApp({
      components: {
        'card-component': CardComponent
      },
      data() {
        return {
          // Storage keys
          storageKeys: {
            bought: "boughtCards",
            notes: "cardNotes",
            favorites: "favoriteCards",
            customTabs: "customPokemonTabs",
            customCollections: "customCollections",
            collectionCards: "collectionCards"
          },
          
          // App state
          loading: false,
          currentView: 'all',
          currentCollection: 'charizard',
          allCards: [],
          boughtCards: {},
          cardNotes: {},
          favoriteCards: {},
          customTabs: [],
          customCollections: [],
          collectionCards: {},
          
          // UI state
          views: [
            { id: 'all', icon: 'fas fa-th-large' },
            { id: 'favorites', icon: 'fas fa-star' },
            { id: 'custom', icon: 'fas fa-folder' },
            { id: 'add', icon: 'fas fa-plus' }
          ],
          showAdvancedFilters: false,
          showCollectionForm: false,
          
          // Form inputs
          newPokemonInput: '',
          newCollection: {
            name: '',
            description: '',
            type: 'manual'
          },
          
          // Modal state
          selectedCard: null,
          cardNoteText: '',
          noteSaved: false,
          
          // Search filters
          searchFilters: {
            query: '',
            filterValue: 'all',
            sortValue: 'name',
            reverseOrder: false,
            foilOnly: false,
            year: '',
            priceMin: '',
            priceMax: ''
          },
          
          // Defaults
          defaultPokemonTabs: [
            { name: 'Charizard' },
            { name: 'Cubone' },
            { name: 'Psyduck' },
            { name: 'Pikachu' },
            { name: 'Farfetch\'d' },
            { name: 'Golem' },
            { name: 'Gastly' },
            { name: 'Haunter' },
            { name: 'Gengar' },
            { name: 'Mew' },
            { name: 'Mewtwo' },
            { name: 'Machop' },
            { name: 'Machoke' },
            { name: 'Machamp' }
          ]
        }
      },
      computed: {
        pokemonTabs() {
          // Combine default tabs with custom tabs
          const customTabObjects = this.customTabs.map(name => ({ name }));
          return [...this.defaultPokemonTabs, ...customTabObjects];
        },
        filteredCards() {
          const query = this.searchFilters.query.toLowerCase();
          const filterValue = this.searchFilters.filterValue;
          const sortValue = this.searchFilters.sortValue;
          const year = this.searchFilters.year.toLowerCase();
          const foilOnly = this.searchFilters.foilOnly;
          const priceMin = parseFloat(this.searchFilters.priceMin) || 0;
          const priceMax = parseFloat(this.searchFilters.priceMax) || Infinity;
          
          let filtered = this.allCards.filter(card => {
            // Search query
            const matchesSearch =
              (card.name && card.name.toLowerCase().includes(query)) ||
              (card.set?.name && card.set.name.toLowerCase().includes(query)) ||
              (card.number && card.number.toString().includes(query)) ||
              (card.rarity && card.rarity.toLowerCase().includes(query));
            if (!matchesSearch) return false;
            
            // Year filter
            const releaseYear = card.set && card.set.releaseDate ? card.set.releaseDate.split("/")[0] : "";
            if (year && (!releaseYear || !releaseYear.toLowerCase().includes(year))) return false;
            
            // Foil only filter
            if (foilOnly && (!card.rarity || !card.rarity.toLowerCase().includes("holo"))) return false;
            
            // Price filtering
            if (priceMin > 0 || priceMax < Infinity) {
              let cardPrice = 0;
              if (card.tcgplayer?.prices) {
                const priceObj = Object.values(card.tcgplayer.prices)[0];
                cardPrice = priceObj?.market || priceObj?.mid || 0;
              } else if (card.cardmarket?.prices) {
                cardPrice = card.cardmarket.prices.averageSellPrice || card.cardmarket.prices.trendPrice || 0;
              }
              if (cardPrice < priceMin || cardPrice > priceMax) return false;
            }
            
            // Card status filters
            if (filterValue === "bought" && !this.boughtCards[card.id]) return false;
            if (filterValue === "notBought" && this.boughtCards[card.id]) return false;
            if (filterValue === "favorites" && !this.favoriteCards[card.id]) return false;
            
            return true;
          });
          
          // Sorting
          filtered.sort((a, b) => {
            switch (sortValue) {
              case "name":
                return a.name.localeCompare(b.name);
              case "set":
                return (a.set?.name || "").localeCompare(b.set?.name || "");
              case "number":
                return (parseInt(a.number) || 0) - (parseInt(b.number) || 0);
              case "rarity":
                return (a.rarity || "").localeCompare(b.rarity || "");
              case "printYear": {
                const yearA = parseInt(a.set?.releaseDate ? a.set.releaseDate.split("/")[0] : "0", 10);
                const yearB = parseInt(b.set?.releaseDate ? b.set.releaseDate.split("/")[0] : "0", 10);
                return yearA - yearB;
              }
              default:
                return 0;
            }
          });
          
          // Reverse order if needed
          if (this.searchFilters.reverseOrder) {
            filtered.reverse();
          }
          
          return filtered;
        },
        favoriteCardsList() {
          const favoriteIds = Object.keys(this.favoriteCards).filter(id => this.favoriteCards[id]);
          return this.allCards.filter(card => favoriteIds.includes(card.id));
        },
        boughtCount() {
          return Object.keys(this.boughtCards).filter(id => 
            this.allCards.some(card => card.id === id) && this.boughtCards[id]
          ).length;
        },
        favoriteCount() {
          return Object.keys(this.favoriteCards).filter(id => 
            this.allCards.some(card => card.id === id) && this.favoriteCards[id]
          ).length;
        }
      },
      methods: {
        async loadFromLocalStorage() {
          // Load data from localStorage
          this.boughtCards = JSON.parse(localStorage.getItem(this.storageKeys.bought)) || {};
          this.cardNotes = JSON.parse(localStorage.getItem(this.storageKeys.notes)) || {};
          this.favoriteCards = JSON.parse(localStorage.getItem(this.storageKeys.favorites)) || {};
          this.customTabs = JSON.parse(localStorage.getItem(this.storageKeys.customTabs)) || [];
          this.customCollections = JSON.parse(localStorage.getItem(this.storageKeys.customCollections)) || [];
          this.collectionCards = JSON.parse(localStorage.getItem(this.storageKeys.collectionCards)) || {};
        },
        
        saveToLocalStorage(key, data) {
          localStorage.setItem(key, JSON.stringify(data));
        },
        
        async loadCards(forceRefresh = false) {
          this.loading = true;
          const cacheKey = "cachedCards_" + this.currentCollection;
          const cacheTimestampKey = "cacheTimestamp_" + this.currentCollection;
          const now = Date.now();
          const oneDay = 24 * 60 * 60 * 1000;
          const cachedData = localStorage.getItem(cacheKey);
          const cachedTimestamp = localStorage.getItem(cacheTimestampKey);
          
          if (!forceRefresh && cachedData && cachedTimestamp && now - parseInt(cachedTimestamp) < oneDay) {
            this.allCards = JSON.parse(cachedData);
            this.loading = false;
            return;
          }
          
          const query = "name:" + this.currentCollection;
          try {
            const response = await fetch("https://api.pokemontcg.io/v2/cards?q=" + encodeURIComponent(query));
            const { data } = await response.json();
            this.allCards = data;
            this.saveToLocalStorage(cacheKey, this.allCards);
            this.saveToLocalStorage(cacheTimestampKey, now);
          } catch (error) {
            console.error("Error fetching cards:", error);
            const cached = localStorage.getItem(cacheKey);
            if (cached) {
              this.allCards = JSON.parse(cached);
            } else {
              this.allCards = [];
            }
          } finally {
            this.loading = false;
          }
        },
        
        refreshCards() {
          const cacheKey = "cachedCards_" + this.currentCollection;
          const cacheTimestampKey = "cacheTimestamp_" + this.currentCollection;
          localStorage.removeItem(cacheKey);
          localStorage.removeItem(cacheTimestampKey);
          this.loadCards(true);
        },
        
        // View and Navigation
        changeView(viewId) {
          this.currentView = viewId;
        },
        
        selectCollection(collectionName) {
          this.currentCollection = collectionName;
          this.loadCards();
        },
        
        toggleAdvancedFilters() {
          this.showAdvancedFilters = !this.showAdvancedFilters;
        },
        
        // Card Actions
        toggleCardBought(cardId) {
          this.boughtCards[cardId] = !this.boughtCards[cardId];
          this.saveToLocalStorage(this.storageKeys.bought, this.boughtCards);
        },
        
        toggleCardFavorite(cardId) {
          this.favoriteCards[cardId] = !this.favoriteCards[cardId];
          this.saveToLocalStorage(this.storageKeys.favorites, this.favoriteCards);
        },
        
        // Modal handling
        openCardModal(card) {
          this.selectedCard = card;
          this.cardNoteText = this.cardNotes[card.id] || '';
          this.noteSaved = false;
          document.body.style.overflow = 'hidden';
        },
        
        closeCardModal() {
          this.selectedCard = null;
          document.body.style.overflow = 'auto';
        },
        
        saveCardNote() {
          if (!this.selectedCard) return;
          
          this.cardNotes[this.selectedCard.id] = this.cardNoteText;
          this.saveToLocalStorage(this.storageKeys.notes, this.cardNotes);
          this.noteSaved = true;
          
          setTimeout(() => {
            this.noteSaved = false;
          }, 1500);
        },
        
        // Pokemon Tab Management
        addNewPokemon() {
          const pokemonName = this.newPokemonInput.trim();
          if (!pokemonName) {
            alert("Please enter a Pokemon name");
            return;
          }
          
          const exists = this.pokemonTabs.some(tab => 
            tab.name.toLowerCase() === pokemonName.toLowerCase()
          );
          
          if (exists) {
            alert("This Pokemon is already in your collection!");
            return;
          }
          
          this.customTabs.push(pokemonName.toLowerCase());
          this.saveToLocalStorage(this.storageKeys.customTabs, this.customTabs);
          this.newPokemonInput = '';
          this.changeView('all');
          this.selectCollection(pokemonName.toLowerCase());
        },
        
        handleTabRemoval(pokemonName) {
          const defaultPokemon = this.defaultPokemonTabs.map(tab => tab.name.toLowerCase());
          if (defaultPokemon.includes(pokemonName.toLowerCase())) {
            alert("Default Pokemon cannot be removed from the collection.");
            return;
          }
          
          if (confirm(`Remove ${pokemonName} from your collection tabs?`)) {
            this.customTabs = this.customTabs.filter(name => name !== pokemonName.toLowerCase());
            this.saveToLocalStorage(this.storageKeys.customTabs, this.customTabs);
            
            if (this.currentCollection === pokemonName.toLowerCase()) {
              this.selectCollection('charizard');
            }
          }
        },
        
        // Custom Collections
        saveCollection() {
          if (!this.newCollection.name.trim()) {
            alert("Please enter a collection name");
            return;
          }
          
          const newCollection = {
            id: "col_" + Date.now(),
            name: this.newCollection.name.trim(),
            description: this.newCollection.description.trim(),
            type: this.newCollection.type,
            created: Date.now(),
            lastModified: Date.now()
          };
          
          this.customCollections.push(newCollection);
          this.saveToLocalStorage(this.storageKeys.customCollections, this.customCollections);
          
          this.collectionCards[newCollection.id] = [];
          this.saveToLocalStorage(this.storageKeys.collectionCards, this.collectionCards);
          
          this.showCollectionForm = false;
          this.newCollection = { name: '', description: '', type: 'manual' };
        },
        
        getCollectionCardCount(collectionId) {
          return this.collectionCards[collectionId] ? this.collectionCards[collectionId].length : 0;
        },
        
        viewCollection(collectionId) {
          const collection = this.customCollections.find(c => c.id === collectionId);
          if (!collection) return;
          alert(`Viewing collection: ${collection.name}\n\nThis would open a detailed view of all cards in this collection.`);
        },
        
        editCollection(collectionId) {
          const collection = this.customCollections.find(c => c.id === collectionId);
          if (!collection) return;
          alert(`Editing collection: ${collection.name}\n\nThis would open a form to edit the collection details.`);
        },
        
        deleteCollection(collectionId) {
          const collection = this.customCollections.find(c => c.id === collectionId);
          if (!collection) return;
          
          if (confirm(`Are you sure you want to delete the collection "${collection.name}"?`)) {
            this.customCollections = this.customCollections.filter(c => c.id !== collectionId);
            this.saveToLocalStorage(this.storageKeys.customCollections, this.customCollections);
            
            delete this.collectionCards[collectionId];
            this.saveToLocalStorage(this.storageKeys.collectionCards, this.collectionCards);
          }
        },
        
        // Helper functions
        getTypeIcon(type) {
          const iconMap = {
            fire: "fire",
            water: "tint",
            grass: "leaf",
            electric: "bolt",
            psychic: "brain",
            fighting: "fist-raised",
            darkness: "moon",
            metal: "cog",
            fairy: "magic",
            dragon: "dragon",
            colorless: "feather",
            default: "certificate"
          };
          return iconMap[type] || iconMap.default;
        },
        
        formatPrice(price) {
          return price ? `$${parseFloat(price).toFixed(2)}` : "N/A";
        },
        
        getPriceValue(card, key) {
          if (!card.tcgplayer?.prices) return null;
          const priceType = Object.keys(card.tcgplayer.prices)[0];
          if (!priceType || !card.tcgplayer.prices[priceType]) return null;
          return card.tcgplayer.prices[priceType][key];
        },
        
        getReleaseYear(card) {
          return card.set && card.set.releaseDate ? card.set.releaseDate.split("/")[0] : "N/A";
        }
      },
      mounted() {
        // Initialize app
        this.loadFromLocalStorage();
        this.loadCards();
        
        // Close modal with escape key
        window.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && this.selectedCard) {
            this.closeCardModal();
          }
        });
      }
    });
    
    app.mount('#app');
  </script>
</body>
</html>